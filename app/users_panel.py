from aiogram import F, Router
from aiogram.types import Message, ReplyKeyboardRemove
from aiogram.filters.command import Command, CommandStart

from create_bot import admins

import app.keyboards as kb

import Database.request as rq

user_router = Router()


""" –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã start """
@user_router.message(CommandStart())
@user_router.message(Command('menu'))
async def start_com(message: Message):
    await rq.set_user(tg_id=message.from_user.id, username=message.from_user.username)
    await message.answer(f"""
üåü –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, <b>{message.from_user.first_name}</b>!

–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω–æ–º—É –∑–∞–∫—Ä—ã—Ç–æ–º—É –¢–ì-–∫–∞–Ω–∞–ª—É, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ—Ñ–æ—Ä–º–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É –∑–∞ 5 —Ä—É–±–ª–µ–π.
–ß—Ç–æ –¥–∞—ë—Ç –ø–æ–¥–ø–∏—Å–∫–∞?

‚úÖ –î–æ—Å—Ç—É–ø –∫ –∑–∞–∫—Ä—ã—Ç–æ–º—É –¢–ì–ö —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏ –∏ "–ø–ª—é—à–∫–∞–º–∏"
‚úÖ –ú–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –∫—É—Ä—Å–∞–º–∏ –∏ –æ–±—É—á–∞—é—â–∏–º–∏ –≤–∏–¥–µ–æ –ø–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π
–ö–∞–∫ –æ–ø–ª–∞—Ç–∏—Ç—å?

    –í–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å –∫–æ–º–∞–Ω–¥–æ–π /payments

    –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

    –ü–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ–ø–ª–∞—Ç—ã –≤—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∏—Ç–µ –¥–æ—Å—Ç—É–ø

üí° –°—Å—ã–ª–∫–∞ –Ω–∞ –∫–∞–Ω–∞–ª –ø—Ä–∏–¥–µ—Ç —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã –∏ –±—É–¥–µ—Ç –∞–∫—Ç–∏–≤–Ω–∞ 10 –º–∏–Ω—É—Ç. –ï—Å–ª–∏ –Ω–µ —É—Å–ø–µ–ª–∏ ‚Äî –∑–∞–ø—Ä–æ—Å–∏—Ç–µ –Ω–æ–≤—É—é —á–µ—Ä–µ–∑ /getlink
""", reply_markup=kb.main_menu)
    

""" –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã '–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å' """
@user_router.message(F.text == "–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å")
@user_router.message(Command('my_profile'))
async def my_profile(message: Message):
    user_info = await rq.user_info(tg_id=message.from_user.id) # –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è, –≤ –∫–æ—Ç–æ—Ä–æ–π —Ö—Ä–∞–Ω–∏—Ç—å—Å—è —Å–ø–∏—Å–æ–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –Ω–∞—à–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
    
    # –î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –≤ –∫—Ä–∞—Å–∏–≤–æ–º –≤–∏–¥–µ –≤—ã–≤–æ–¥–∏–ª–æ—Å—å user_info['is_paid']
    if user_info['is_paid'] == False:
        await message.answer(f"""
–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ –≤–∞—à–µ–º—É –ø—Ä–æ—Ñ–∏–ª—é:
    
    –ò–º—è - {user_info['username']}.
    –ê–∫–∫–∞—É–Ω—Ç –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ –±–æ—Ç–µ —Å - {user_info['created_time']}.
    –ü–æ–¥–ø–∏—Å–∫–∞ –¥–ª—è –∑–∞–∫—Ä—ã—Ç–æ–≥–æ —Ç–≥–∫ - –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç.

–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É, —Ç–æ –≤–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å –∫–æ–º–∞–Ω–¥–æ–π /start
""", reply_markup=ReplyKeyboardRemove())
    else:
        await message.answer(f"""
–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ –≤–∞—à–µ–º—É –ø—Ä–æ—Ñ–∏–ª—é:
    
    –ò–º—è - {user_info['username']}.
    –ê–∫–∫–∞—É–Ω—Ç –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ –±–æ—Ç–µ —Å - {user_info['created_time']}.
    –ü–æ–¥–ø–∏—Å–∫–∞ –¥–ª—è –∑–∞–∫—Ä—ã—Ç–æ–≥–æ —Ç–≥–∫ - –ê–∫—Ç–∏–≤–Ω–∞.

–í–∞—à–∞ –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç!
""", reply_markup=ReplyKeyboardRemove())


""" –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã '–ü–æ–¥–¥–µ—Ä–∂–∫–∞' """
@user_router.message(F.text == "–ü–æ–¥–¥–µ—Ä–∂–∫–∞")
@user_router.message(Command('help'))
async def helper(message: Message):
    await message.answer("""
üõéÔ∏è –ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å?

–ù–µ —Å—Ç–µ—Å–Ω—è–π—Å—è –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –Ω–∞—à–µ–º—É –º–µ–Ω–µ–¥–∂–µ—Ä—É! –û–Ω —Å —Ä–∞–¥–æ—Å—Ç—å—é –æ—Ç–≤–µ—Ç–∏—Ç –Ω–∞ –≤—Å–µ —Ç–≤–æ–∏ –≤–æ–ø—Ä–æ—Å—ã –∏ –ø–æ–º–æ–∂–µ—Ç —Å –ø–æ–¥–ø–∏—Å–∫–æ–π. üí¨

üëâ –ù–∞–ø–∏—à–∏ —Å—é–¥–∞: @Zakazforkwork1_Support

–ú—ã –Ω–∞ —Å–≤—è–∑–∏ 24/7 –∏ —Å–¥–µ–ª–∞–µ–º –≤—Å—ë, —á—Ç–æ–±—ã —Ç–≤–æ–π –æ–ø—ã—Ç –±—ã–ª –∏–¥–µ–∞–ª—å–Ω—ã–º! üåü

""", reply_markup=kb.support_button)
    
""" –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã 'WebApp' """
@user_router.message(Command('WebApp'))
async def WebApp_menu(message: Message):
    user = await rq.user_info(tg_id=message.from_user.id)

    if not user or user.get("is_paid") == False:
        await message.answer("""
üîí –î–æ—Å—Ç—É–ø –∑–∞–∫—Ä—ã—Ç!

–ò–∑–≤–∏–Ω–∏—Ç–µ, <b>{message.from_user.first_name}</b>, –Ω–æ —ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –ø–æ–¥–ø–∏—Å—á–∏–∫–∞–º SkillBrick.

–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø?

1Ô∏è‚É£ –í–≤–µ–¥–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É /payments
2Ô∏è‚É£ –û–ø–ª–∞—Ç–∏—Ç–µ –ø–æ–¥–ø–∏—Å–∫—É –≤—Å–µ–≥–æ 5 —Ä—É–±–ª–µ–π
3Ô∏è‚É£ –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ –ø–æ–ª—É—á–∏—Ç–µ –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º
–í–∞—à–∏ –≤—ã–≥–æ–¥—ã –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã:

‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –≤–∏–¥–µ–æ—É—Ä–æ–∫–æ–≤ –ø–æ –º–æ—Å—Ç–æ—Å—Ç—Ä–æ–µ–Ω–∏—é
‚úÖ –î–æ—Å—Ç—É–ø –∫ –∑–∞–∫—Ä—ã—Ç–æ–º—É —Å–æ–æ–±—â–µ—Å—Ç–≤—É
‚úÖ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–¥–∞–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã —ç–∫—Å–ø–µ—Ä—Ç–∞–º

–ù–µ —É–ø—É—Å—Ç–∏—Ç–µ —à–∞–Ω—Å —Å—Ç–∞—Ç—å –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª–æ–º!
""")
    
    await message.answer("–í—ã–±–µ—Ä–∏—Ç–µ –Ω–∏–∂–µ –∏–∑ —Å–ø–∏—Å–∫–∞ –Ω—É–∂–Ω–æ–µ –¥–ª—è –í–∞—Å WebApp-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ", reply_markup=kb.webapp_menu)